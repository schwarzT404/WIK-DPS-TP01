# Analyse de vulrabili - Application Dwidder

## su technique

L'application Dwidder psente une vulrabili permettant de contourner le systtnrmRtn me de code d'invitation lors 
de l'inscription. Cette vulrabili est de type **injection de paramtn
tres** qui exploite une mauvaise validation des entes utilisateur.

## Vulrabili identife

### Type de vulrabili
Contournement de contrle d'acctnitnr s par manipulation de param
tres

### Description technique
Lors de l'analyse du code source, nous avons identif que le processus d'inscription utilise un middleware de 
validation qui rifie si le paramvi
tre `invitationCode` est psent et valide. Cependant, la validation n'est pas correctement impmene et peuttre contoure.

La route d'inscription (`/register`) utilise une thode POST qui traite les dones fournies par l'utilisateur. Le 
problnmntlr me vient du fait que l'application valide le code d'invitation dans le middleware mais n'applique 
pas cette validation de mani
re stricte lors du traitement final de la reqte.

### Exploitation

La vulrabili peuttre exploie de plusieurs fas paramttn tres JSON**: En modifiant la structure du corps JSON 
envo, il est possible de faire passer un paramy
tre `invitationCode` pour la validation, mais d'utiliser un autre objet (comme `user.invitationCode`) pour l'enregistrement effectif.

2. **Injection de param tres HTTP**: En envoyant deux param tres avec le me nom mais des valeurs difrentes, 
certains frameworks prennent en compte la dernif re valeur pour le traitement mais la premi
re pour la validation.

3. **HTTP Parameter Pollution**: En utilisant des param tres dupliqs, on peut confondre la logique d'analyse des 
paramu
tres.

Exemple d'exploitation:
```http
POST /register HTTP/1.1
Host: dwidder.example.com
Content-Type: application/json

{
  "username": "newuser",
  "password": "password123",
  "invitationCode": "FAKE-CODE",
  "user": {
    "username": "newuser",
    "password": "password123",
    "invitationCode": null
  }
}
```

Dans cet exemple, le middleware rifie `invitationCode` au premier niveau, tandis que la fonction d'inscription utilise `user.invitationCode` qui est null, ce qui contourne la rification.

## Correction recommane

Pour corriger cette vulrabili, plusieurs mesures doiventtre prises:

1. **Validation corente**: S'assurer que la me structure de dones est utilie snhtndvv la fois pour la validation et pour le traitement.

2. **Sanitization des entes**: Nettoyer et valider toutes les entes avant traitement.

3. **Validation c serveur**: Impmenter une validation robuste c serveur avec un scma de validation strict.

4. **rification en profondeur**: rifier tous les niveaux d'imbrication des objets JSON.

Exemple de correction (pseudo-code):
```javascript
// Middleware de validation
function validateInvitationCode(req, res, next) {
  // Extraction de l'objet user normali
  const userData = normalizeUserInput(req.body);
  
  // rification explicite du code d'invitation
  if (!userData.invitationCode || !isValidInvitationCode(userData.invitationCode)) {
    return res.status(403).json({ error: "Code d'invitation invalide" });
  }
  
  // Stockage des dones normalies pour le handler
  req.validatedUserData = userData;
  next();
}

// Handler d'inscription
function registerUser(req, res) {
  // Utilisation uniquement des dones valies
  const userData = req.validatedUserData;
  
  // Cation de l'utilisateur avec les dones valies
  createUser(userData)
    .then(user => res.status(201).json({ success: true, user }))
    .catch(err => res.status(500).json({ error: err.message }));
}
```

## Impact de la vulrabili

Cette vulrabili permet tntndnrdnsnVsVVhtltrr n'importe qui de s'inscrire sur la plateforme sans disposer d'un code d'invitation valide, ce qui pourrait entraner:

1. Contournement du syst me d'invitation restreint 2. Inscription massive d'utilisateurs non autoris 3. Atteinte 
potentielle s la confiance des utilisateurs gitimes 4. Surcharge possible du systl
me par des inscriptions non contres

## Conclusion

Cette vulrabili repsente un risque mo pour l'application Dwidder, car elle permet de contourner un canisme de 
contrle d'accmrdrtnl
s important. La correction est relativement simple  mettre en ouvre et devraittre appliqe rapidement pourviter des inscriptions non autories.s u
